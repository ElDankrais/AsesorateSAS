<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>AsesorateSAS</title>
</head>
<script>localStorage.setItem('id_estudiante',1)</script>
<body>
    <form>
        {% csrf_token %}
        <label for="horas">Horas de asesoría:</label>
        <input type="number" name="horas" required>
        <br>
        <label for="id_categoria">Seleccione una categoria:</label>
        <select name="id_categoria" required>
            <option value='JR'>JUNIOR</option>
            <option value='SB'>SENIOR BASIC</option>
            <option value='SM'>SENIOR MEDIUM</option>
            <option value='SA1'>SENIOR ADVANCED 1</option>
            <option value='SA2'>SENIOR ADVANCED 2</option>
        </select>
        <br>
        <button type="submit">Cotizar</button>
    </form>

    <div style="visibility: hidden" id="resultado">
        <h3>El precio de su cotización es:</h3>
        <input id="cotizacion" type="text" disabled>
    </div>

    <table>
        
    </table>
</body>
<script>
$("form").submit(function(event) {
  event.preventDefault();
  var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
  var horas = jQuery("[name=horas]").val();
  var id_categoria = jQuery("[name=id_categoria]").val();
  //PARA INSERTAR EN EL LOCALSTORAGE SE ACCEDE A LA CONSOLA DEL NAVEGADOR
  //PONER: localStorage.setItem('id_estudiante',1)
  var id_estudiante = localStorage.getItem('id_estudiante'); //SE DEBE EXTRAER DE LA SESIÓN, ACA LO COGEMOS DEL LOCALSTORAGE PORQUE AÚN NO TENEMOS LA TABLA

  $.ajax({
      url: '../cotizar/',
      type: 'POST',
      data: {
          csrfmiddlewaretoken: csrftoken,
          horas: parseInt(horas),
          id_categoria: id_categoria,
          id_estudiante: id_estudiante
      },
      dataType: "json",
        success: function (response, request) {
            
            document.getElementById("cotizacion").value = response.precio.toString();
            jQuery("[id=resultado]").css("visibility",'visible')
    },
    error: function(jqXHR, textStatus, errorThrown){
        console.log(textStatus)
        console.log(jqXHR)
          }
  });
}); 
</script>
<style>
    #cotizacion{
        border:none;
        color: limegreen;
        font-weight: bold;
        background: inherit;
    }
</style>
</html>